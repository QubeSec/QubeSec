# QuantumEncapsulateSecret uses a KEM public key to perform encapsulation,
# generating a shared secret and ciphertext. The ciphertext can be sent to another party
# who can decapsulate it using the corresponding private key.
apiVersion: qubesec.io/v1
kind: QuantumEncapsulateSecret
metadata:
  labels:
    app.kubernetes.io/name: quantumencapsulatesecret
    app.kubernetes.io/instance: quantumencapsulatesecret-sample
    app.kubernetes.io/part-of: qubesec
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/created-by: qubesec
  name: quantumencapsulatesecret-sample
spec:
  # publicKeyRef: Reference to the QuantumKEMKeyPair that contains the public key
  publicKeyRef:
    name: quantumkemkeypair-sample
    namespace: default
  
  # algorithm: Must match the algorithm used in the referenced KeyPair
  # The controller will read the KEM public key from the secret named in that KEM's spec.secretName
  algorithm: ML-KEM-1024
  
  # secretName: Kubernetes Secret where the derived shared secret is stored
  # Output: Secret containing 'shared-secret' field (hex-encoded)
  # The ciphertext is stored in status.ciphertext for later decapsulation
  secretName: quantumencapsulatesecret-sample-sharedsecret
  
  # Optional: Name of secret to store the shared secret in
  # If not provided, a secret will be created with a generated name
  secretName: quantumencapsulatesecret-sample-sharedsecret
