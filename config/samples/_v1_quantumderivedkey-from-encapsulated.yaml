# QuantumDerivedKey derives a cryptographic key from a shared secret using HKDF-SHA256.
# This example derives a key from the shared secret created by QuantumEncapsulateSecret.
# The output is suitable for encryption (AES-256) or other cryptographic operations.
apiVersion: qubesec.io/v1
kind: QuantumDerivedKey
metadata:
  labels:
    app.kubernetes.io/name: quantumderivedkey
    app.kubernetes.io/instance: quantumderivedkey-from-encapsulated
    app.kubernetes.io/part-of: qubesec
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/created-by: qubesec
  name: quantumderivedkey-from-encapsulated
spec:
  # sharedSecretRef: Reference to a QuantumEncapsulateSecret or QuantumDecapsulateSecret
  sharedSecretRef:
    name: quantumencapsulatesecret-sample
    namespace: default
  
  # keyType: Type of key to derive
  # Options: AES-256 (256-bit AES), ChaCha20 (256-bit ChaCha20), HMAC-SHA256 (256-bit HMAC)
  keyType: AES-256
  
  # salt: Optional salt for HKDF (hex-encoded, leave empty for no salt)
  # Increases entropy if the shared secret derivation needs additional randomness
  salt: ""
  
  # info: Optional info/context string for HKDF (hex-encoded, leave empty for no info)
  # Allows domain separation when deriving multiple keys from same shared secret
  info: ""
  
  # secretName: Kubernetes Secret where the derived key is stored
  # Output: Secret containing 'key' field (hex-encoded)
  # Also includes fingerprint in status for verification
  secretName: quantumderivedkey-from-encapsulated
  # If not provided, an empty salt is used for deterministic derivation
  # To get the same key every time, use the same salt (or leave empty)
  salt: ""
  
  # Optional: Info for HKDF (hex-encoded)
  # If not provided, empty info is used
  info: ""
  
  # Optional: Name of secret to store the derived key in
  # If not provided, a secret will be created with a generated name
  secretName: quantumderivedkey-from-encapsulated-aes256
